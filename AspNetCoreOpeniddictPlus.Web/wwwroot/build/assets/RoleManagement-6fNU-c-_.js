import{j as e,r as o,L as K}from"./App-_4Dsq98a.js";import{c as X,B as k,u as U,a as Z,b as G,d as J,e as Q,f as R,P as Y,g as I,A as T,C as D,h as M,i as H,D as ee,j as se,k as te,l as re,m as ne,L as ie,I as oe,n as ae,o as ce,T as le,p as de,q as A,r as w,s as ue,t as N,v as he,w as fe,x as z,y as me,z as pe,E as xe}from"./useError-CaRTd7CK.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ge=X("Check",je);function be({role:s}){return e.jsxs("form",{method:"post",action:"/roles/delete",children:[e.jsx("span",{className:"hidden",dangerouslySetInnerHTML:{__html:window.__RequestVerificationToken}}),e.jsx("input",{type:"hidden",name:"id",value:s.roleId}),e.jsx(k,{variant:"destructive",size:"icon",type:"submit",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-archive-fill",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M12.643 15C13.979 15 15 13.845 15 12.5V5H1v7.5C1 13.845 2.021 15 3.357 15zM5.5 7h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1M.8 1a.8.8 0 0 0-.8.8V3a.8.8 0 0 0 .8.8h14.4A.8.8 0 0 0 16 3V1.8a.8.8 0 0 0-.8-.8z"})})})]})}function ve(s){const t=o.useRef({value:s,previous:s});return o.useMemo(()=>(t.current.value!==s&&(t.current.previous=t.current.value,t.current.value=s),t.current.previous),[s])}function ye(s){const[t,r]=o.useState(void 0);return U(()=>{if(s){r({width:s.offsetWidth,height:s.offsetHeight});const i=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const n=a[0];let d,l;if("borderBoxSize"in n){const h=n.borderBoxSize,p=Array.isArray(h)?h[0]:h;d=p.inlineSize,l=p.blockSize}else d=s.offsetWidth,l=s.offsetHeight;r({width:d,height:l})});return i.observe(s,{box:"border-box"}),()=>i.unobserve(s)}else r(void 0)},[s]),t}var L=o.forwardRef((s,t)=>{const{children:r,...i}=s,a=o.Children.toArray(r),n=a.find(we);if(n){const d=n.props.children,l=a.map(h=>h===n?o.Children.count(d)>1?o.Children.only(null):o.isValidElement(d)?d.props.children:null:h);return e.jsx(P,{...i,ref:t,children:o.isValidElement(d)?o.cloneElement(d,void 0,l):null})}return e.jsx(P,{...i,ref:t,children:r})});L.displayName="Slot";var P=o.forwardRef((s,t)=>{const{children:r,...i}=s;if(o.isValidElement(r)){const a=ke(r),n=Ne(i,r.props);return r.type!==o.Fragment&&(n.ref=t?Z(t,a):a),o.cloneElement(r,n)}return o.Children.count(r)>1?o.Children.only(null):null});P.displayName="SlotClone";var Ce=({children:s})=>e.jsx(e.Fragment,{children:s});function we(s){return o.isValidElement(s)&&s.type===Ce}function Ne(s,t){const r={...t};for(const i in t){const a=s[i],n=t[i];/^on[A-Z]/.test(i)?a&&n?r[i]=(...l)=>{n(...l),a(...l)}:a&&(r[i]=a):i==="style"?r[i]={...a,...n}:i==="className"&&(r[i]=[a,n].filter(Boolean).join(" "))}return{...s,...r}}function ke(s){var i,a;let t=(i=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var Pe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],_=Pe.reduce((s,t)=>{const r=o.forwardRef((i,a)=>{const{asChild:n,...d}=i,l=n?L:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...d,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{}),E="Checkbox",[Ee,Le]=G(E),[Se,Re]=Ee(E),V=o.forwardRef((s,t)=>{const{__scopeCheckbox:r,name:i,checked:a,defaultChecked:n,required:d,disabled:l,value:h="on",onCheckedChange:p,form:x,...c}=s,[u,f]=o.useState(null),j=J(t,m=>f(m)),y=o.useRef(!1),S=u?x||!!u.closest("form"):!0,[b=!1,C]=Q({prop:a,defaultProp:n,onChange:p}),$=o.useRef(b);return o.useEffect(()=>{const m=u==null?void 0:u.form;if(m){const v=()=>C($.current);return m.addEventListener("reset",v),()=>m.removeEventListener("reset",v)}},[u,C]),e.jsxs(Se,{scope:r,state:b,disabled:l,children:[e.jsx(_.button,{type:"button",role:"checkbox","aria-checked":g(b)?"mixed":b,"aria-required":d,"data-state":F(b),"data-disabled":l?"":void 0,disabled:l,value:h,...c,ref:j,onKeyDown:R(s.onKeyDown,m=>{m.key==="Enter"&&m.preventDefault()}),onClick:R(s.onClick,m=>{C(v=>g(v)?!0:!v),S&&(y.current=m.isPropagationStopped(),y.current||m.stopPropagation())})}),S&&e.jsx(Ie,{control:u,bubbles:!y.current,name:i,value:h,checked:b,required:d,disabled:l,form:x,style:{transform:"translateX(-100%)"},defaultChecked:g(n)?!1:n})]})});V.displayName=E;var B="CheckboxIndicator",O=o.forwardRef((s,t)=>{const{__scopeCheckbox:r,forceMount:i,...a}=s,n=Re(B,r);return e.jsx(Y,{present:i||g(n.state)||n.state===!0,children:e.jsx(_.span,{"data-state":F(n.state),"data-disabled":n.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...s.style}})})});O.displayName=B;var Ie=s=>{const{control:t,checked:r,bubbles:i=!0,defaultChecked:a,...n}=s,d=o.useRef(null),l=ve(r),h=ye(t);o.useEffect(()=>{const x=d.current,c=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(c,"checked").set;if(l!==r&&f){const j=new Event("click",{bubbles:i});x.indeterminate=g(r),f.call(x,g(r)?!1:r),x.dispatchEvent(j)}},[l,r,i]);const p=o.useRef(g(r)?!1:r);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??p.current,...n,tabIndex:-1,ref:d,style:{...s.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function g(s){return s==="indeterminate"}function F(s){return g(s)?"indeterminate":s?"checked":"unchecked"}var W=V,Ae=O;const q=o.forwardRef(({className:s,...t},r)=>e.jsx(W,{ref:r,className:I("oidc-peer oidc-h-4 oidc-w-4 oidc-shrink-0 oidc-rounded-sm oidc-border oidc-border-primary oidc-shadow focus-visible:oidc-outline-none focus-visible:oidc-ring-1 focus-visible:oidc-ring-ring disabled:oidc-cursor-not-allowed disabled:oidc-opacity-50 data-[state=checked]:oidc-bg-primary data-[state=checked]:oidc-text-primary-foreground",s),...t,children:e.jsx(Ae,{className:I("oidc-flex oidc-items-center oidc-justify-center oidc-text-current"),children:e.jsx(ge,{className:"oidc-h-4 oidc-w-4"})})}));q.displayName=W.displayName;function ze({currentRoleId:s}){const[t,r]=o.useState(),[i,a]=o.useState(null),[n]=o.useState(()=>new AbortController),[d,l]=o.useState([]),h=(t==null?void 0:t.items)??[],p=c=>c.includes(s),x=c=>h.find(u=>u.permissionId===c);return o.useEffect(()=>{async function c(){try{const u=await fetch("/api/permissions",{signal:n.signal});if(!u.ok)throw new Error("An error occurred while fetching permissions");const f=await u.json();r(f)}catch(u){u instanceof Error&&a(u.message)}}return c().catch(console.error),()=>n.abort()},[s,n]),o.useEffect(()=>{t!=null&&t.items&&l(t.items.filter(c=>p(c.roleIds)).map(c=>c.permissionId))},[t==null?void 0:t.items]),e.jsxs("div",{children:[e.jsx("h1",{className:"oidc-font-semibold",children:"Permissions"}),i&&e.jsxs(T,{variant:"destructive",className:"oidc-mb-3",children:[e.jsx(D,{className:"oidc-h-4 oidc-w-4"}),e.jsx(M,{children:"Error"}),e.jsx(H,{children:i})]}),d.map((c,u)=>{var f,j;return e.jsxs(o.Fragment,{children:[e.jsx("input",{type:"hidden",name:`permissions[${u}][name]`,value:(f=x(c))==null?void 0:f.name}),e.jsx("input",{type:"hidden",name:`permissions[${u}][permissionId]`,value:(j=x(c))==null?void 0:j.permissionId})]},u)}),h.map(c=>e.jsx("div",{children:e.jsxs("div",{className:"oidc-flex oidc-items-center oidc-space-x-2",children:[e.jsx(q,{id:c.permissionId,className:"oidc-my-2",defaultChecked:p(c.roleIds),onCheckedChange:u=>{l(f=>u?[...f,c.permissionId]:f.filter(j=>j!==c.permissionId))}}),e.jsx("label",{htmlFor:c.permissionId,className:"oidc-text-sm oidc-font-medium oidc-leading-none oidc-peer-disabled:cursor-not-allowed oidc-peer-disabled:opacity-70",children:c.name})]})},c.permissionId))]})}function Te({role:s}){return e.jsxs(ee,{children:[e.jsx(se,{asChild:!0,children:e.jsx(k,{size:"icon",variant:"secondary",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-pencil-square",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),e.jsx("path",{"fill-rule":"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"})]})})}),e.jsxs(te,{className:"sm:oidc-max-w-screen-md",children:[e.jsx(re,{children:e.jsxs(ne,{className:"oidc-capitalize",children:["Edit ",s.roleName]})}),e.jsxs("form",{method:"post",action:"/roles/update",children:[e.jsx("span",{className:"hidden",dangerouslySetInnerHTML:{__html:window.__RequestVerificationToken}}),e.jsx("input",{type:"hidden",name:"roleId",value:s.roleId}),e.jsxs("div",{className:"grid oidc-grid-cols-8 gap-4 py-4",children:[e.jsxs("div",{className:"flex oidc-flex-col oidc-col-span-8 oidc-space-y-1",children:[e.jsx(ie,{htmlFor:"roleName",children:"Role Name"}),e.jsx(oe,{id:"roleName",name:"roleName",defaultValue:s.roleName,className:"oidc-w-full"})]}),e.jsx("div",{className:"flex oidc-flex-col oidc-col-span-8 oidc-space-y-1",children:e.jsx(ze,{currentRoleId:s.roleId})})]}),e.jsx(ae,{children:e.jsx(k,{type:"submit",children:"Submit"})})]})]})]})}function De(s){const{roles:t,pageInfo:r,error:i}=s;console.log(t);const a=ce({error:i,autoHide:!0});return e.jsxs("div",{className:"overflow-x-auto",children:[a&&e.jsxs(T,{variant:"destructive",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx(M,{children:"Error"}),e.jsx(H,{children:i})]}),e.jsxs(le,{className:"mt-5",children:[e.jsx(de,{children:e.jsxs(A,{className:"oidc-text-lg",children:[e.jsx(w,{children:"Name"}),e.jsx(w,{children:"Assigned permissions"}),e.jsx(w,{children:"Action"})]})}),e.jsx(ue,{children:t.map(n=>e.jsxs(A,{children:[e.jsx(N,{children:n.roleName}),e.jsxs(N,{children:["Total permissions (",n.permissions.length,")"]}),e.jsxs(N,{className:"flex  oidc-space-x-2",children:[e.jsx(Te,{role:n}),e.jsx(be,{role:n})]})]},n.roleId))})]}),r.totalCount>10&&e.jsx("div",{className:"flex overflow-x-auto justify-center pt-5",children:e.jsx(he,{children:e.jsxs(fe,{children:[e.jsx(z,{children:e.jsx(me,{href:"#"})}),e.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-400",children:["Showing ",e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r.currentPage})," to ",e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r.pageSize})," of ",e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r.totalCount})," Entries"]}),e.jsx(z,{children:e.jsx(pe,{href:"#"})})]})})})]})}function _e(s){console.log(s);const{items:t,currentPage:r,pageSize:i,hasPreviousPage:a,hasNextPage:n,totalCount:d}=s.data,l={currentPage:r,pageSize:i,totalCount:d,hasNextPage:n,hasPreviousPage:a};return e.jsxs(e.Fragment,{children:[e.jsx(K,{children:e.jsx("title",{children:"Admin | Role Management"})}),e.jsx(xe,{title:"Role Management",createType:"role",children:e.jsx(De,{roles:t,pageInfo:l,error:s.error})})]})}export{_e as default};
